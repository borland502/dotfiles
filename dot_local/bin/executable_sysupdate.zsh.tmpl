#!/usr/bin/env zsh

{{ if eq .chezmoi.os "linux" }}
  {{ if findOneExecutable (list "apt") (list "/bin" "/usr/bin" "/usr/local/bin" ".local/bin") }}
    sudo apt update && sudo apt dist-upgrade -y
  {{end}}
{{- end}}

if has brew; then
  #Homebrew update and prune outdated cache
  brew update
  brew upgrade
  brew cleanup -s
  #now diagnostic
  brew doctor
  brew missing
fi

if has npm; then
  # NPM global update
  npm update -g
  npm install -g npm
fi

if has tldr; then
  # misc updates
  tldr --update
fi

if has pipx; then
  pipx upgrade-all
fi

{{- if eq .chezmoi.os "darwin" }}
  # OSX Specific updates
  softwareupdate --all --install --force
{{- end}}

{{- if eq .chezmoi.os "darwin" }}
# OSX Specific updates
softwareupdate --all --install --force
{{- end}}

if [[ $(command -v zinit) ]]; then
  zinit update --all
fi
